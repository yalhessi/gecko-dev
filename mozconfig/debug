# Build only the JS shell
ac_add_options --enable-application=js

# Disable Optimization, for the most accurate debugging experience
ac_add_options --disable-optimize
# Enable the debugging tools: Assertions, debug only code etc.
ac_add_options --enable-debug
# Enable the JIT spew
ac_add_options --enable-jitspew
#### Add Macro information for debugging
###ac_add_options --enable-debug-symbols=-g3

# Enable fuzzing
ac_add_options --enable-fuzzing
#ac_add_options --enable-coverage

# Enable address sanitizer
ac_add_options --enable-address-sanitizer
ac_add_options --enable-undefined-sanitizer

# These three are required by ASan
ac_add_options --disable-jemalloc
ac_add_options --disable-crashreporter

# Keep symbols to symbolize ASan traces later
export MOZ_DEBUG_SYMBOLS=1
ac_add_options --enable-debug-symbols
ac_add_options --disable-install-strip

## ASan specific options on Linux
#ac_add_options --enable-valgrind

# ASan specific options on Linux
ac_add_options --enable-js-fuzzilli

# Additional compiler flags to partially instrument the JS engine
export CFLAGS="-fsanitize-coverage-allowlist=/home/yousef/cache-ir-fuzzer/mozilla-unified/allowlist.txt  -fsanitize-coverage-blocklist=/home/yousef/cache-ir-fuzzer/mozilla-unified/blocklist.txt"
export CXXFLAGS="-fsanitize-coverage-allowlist=/home/yousef/cache-ir-fuzzer/mozilla-unified/allowlist.txt  -fsanitize-coverage-blocklist=/home/yousef/cache-ir-fuzzer/mozilla-unified/blocklist.txt"